function [ ] = heat( G, x, top, flag )

if nargin == 3
    flag = false;
end

bot = 0;

% red
colorBar = [255,230,230
255,204,204
255,179,179
255,153,153
255,128,128
255,102,102
255,77,77
255,51,51
255,26,26
255,0,0
230,0,0
204,0,0
179,0,0
153,0,0
128,0,0
102,0,0
77,0,0
51,0,0
26,0,0
] / 255;

% green
% colorBar = [
%     204,255,204;
%     179,255,179;
%     153,255,153;
%     128,255,128;
%     102,255,102;
%     77,255,77;
%     51,255,51;
%     26,255,26;
%     0,255,0;
%     0,230,0;
%     0,204,0;
%     0,179,0;
%     0,153,0;
%     0,128,0;
%     0,102,0;
%     0,77,0;
%     0,51,0;
%     0,26,0
%     ] / 255;

% colorBar = [166,206,227;
%             31,120,180;
%             178,223,138;
%             51,160,44;
%             251,154,153;
%             227,26,28;
%             253,191,111;
%             255,127,0;
%             202,178,214;
%             106,61,154;
%             255,255,153;
%             177,89,40] / 255;
        
% colorBar = [255,255,204;
%             255,237,160;
%             254,217,118;
%             254,178,76;
%             253,141,60;
%             252,78,42;
%             227,26,28;
%             189,0,38;
%             128,0,38] / 255;

% colorBar = [252,187,161;
%             252,146,114;
%             251,106,74;
%             239,59,44;
%             203,24,29;
%             165,15,21;
%             103,0,13] / 255;

dx = (top - bot) / (size(colorBar, 1) - 1);
c = zeros(G.n, 3);
for k = 1 : size(x, 1)
    for i = 1 : size(colorBar, 1) - 1
        if (x(k) <= (dx * i))
            c(k, :) = colorBar(i, :);
            break;
        end
        c(k, :) = colorBar(end, :);
    end
end

scatter(G.x(:, 1), G.x(:, 2), [], c, 'filled');hold on;

% if flag
%     for i = 1 : G.n
%         idx = G.idx{i};
%         for j = 1 : length(idx)
%             plot([G.x(i, 1), G.x(idx(j), 1)], [G.x(i, 2), G.x(idx(j), 2)], ...
%                 'color', [254,224,210]/255); hold on;
%         end
%     end
% end

axis([0, 1, 0, 1]);

end

